import{r as t,j as s}from"./react-C0aVURRx.js";import{a as A,S as B,e as T}from"./index-BUXUlOD7.js";import{P as W}from"./PageWrapper-BZs1h3P6.js";import{A as D,g}from"./AlertMessage-gDVkVQCd.js";import{P as F}from"./PasswordWithConfirmation-C-PrELzv.js";import{i as N}from"./validation-491qobvS.js";import{u as U}from"./i18n-react-DsoMXUU6.js";import{O as _,a3 as $}from"./vendor-CluA6s6b.js";import{q as c,t as v,G as q,B as C,C as z,ab as G}from"./mui-Bv5YL-XP.js";import"./dayjs-DMyafwSS.js";import"./axios-xsH4HHeE.js";import"./zustand-DgaMZn_z.js";import"./i18n-Bhc83OLH.js";import"./emotion-BXBuUsh5.js";import"./helmet-BXAee230.js";import"./cookie-consent-Eepg6n4_.js";function ns(){const{t:e}=U("passwordReset"),n=_(),R=A.getState().lang,[x]=$(),d=x.get("token")??"",k=x.get("email")??"",[l]=t.useState(k),[i,y]=t.useState(""),[u,M]=t.useState(""),[E,f]=t.useState(!1),[p,h]=t.useState(!1),[w,o]=t.useState(null),[a,S]=t.useState(null),b=N(i),j=i===u;t.useEffect(()=>{(!d||!l)&&n("/login",{replace:!0})},[d,l,n]);const L=async m=>{var P;if(m.preventDefault(),o(null),S(null),f(!0),!b){o(e("errors.passwordNotStrong"));return}if(!j){o(e("errors.passwordsDontMatch"));return}h(!0);try{const{status:r}=await T(d,l,i,u,R);if(r>=200&&r<300)S(e("passwordReset.successMessage"));else throw new Error("Unexpected status")}catch(r){r.response&&((P=r.response.data)!=null&&P.code)?o(g(e,r.response.data.code)):r.isAxiosError?o(g(e,"network_error")):o(g(e,"generic_error"))}finally{h(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(B,{title:e("seo.title"),description:e("seo.description")}),s.jsx(W,{disableCard:!0,children:s.jsxs(c,{component:"form",onSubmit:L,sx:{maxWidth:400,mx:"auto",mt:{xs:1,sm:4,md:8},p:4,borderRadius:2,boxShadow:3,backgroundColor:"background.paper",border:m=>`1px solid ${m.palette.divider}`},children:[s.jsx(v,{variant:"h4",gutterBottom:!0,align:"center",children:e("passwordReset.title")}),s.jsx(v,{variant:"body1",align:"center",sx:{mb:2},children:e("passwordReset.description")}),(w||a)&&s.jsx(c,{"aria-live":"polite",sx:{mb:2},children:s.jsx(D,{message:w??a,severity:a?"success":"error"})}),!a&&s.jsxs(q,{spacing:2,children:[s.jsx(F,{password:i,onPasswordChange:y,confirmPassword:u,onConfirmChange:M,touched:E,onBlur:()=>f(!0)}),s.jsx(C,{type:"submit",variant:"contained",fullWidth:!0,disabled:p||!b||!j,startIcon:p?s.jsx(z,{color:"inherit",size:16}):void 0,children:p?`${e("passwordReset.buttonLoading")}â€¦`:e("passwordReset.button")}),s.jsx(c,{sx:{textAlign:"center",mt:1},children:s.jsx(G,{component:"button",variant:"body2",onClick:()=>n("/login"),children:e("passwordReset.backToLogin")})})]}),a&&s.jsx(c,{sx:{textAlign:"center",mt:2},children:s.jsx(C,{variant:"outlined",onClick:()=>n("/login"),children:e("passwordReset.goToLogin")})})]})})]})}export{ns as default};
