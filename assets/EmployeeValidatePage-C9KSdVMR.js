import{r as n,j as t}from"./react-C0aVURRx.js";import{b as T,a as B,P as y,S as A,A as E}from"./index-CY5QxFiC.js";import{a as F}from"./axios-Dq7h7Pqt.js";import{f as b}from"./format-_gz818Hm.js";import{E as I}from"./ErrorDisplay-CqpRduDy.js";import{F as R}from"./FilterField-pDWxjenY.js";import{y as z,v as r,V as C,q as p,B as f,r as D,C as S,W as P}from"./mui-CUyLNCSY.js";import{g as w}from"./ticket-B4owiMUc.js";import{u as V}from"./i18n-react-DKLIrUu3.js";import"./dayjs-DMyafwSS.js";import"./zustand-DgaMZn_z.js";import"./vendor-DdBxgcTm.js";import"./i18n-Bhc83OLH.js";import"./emotion-3DDxC2qG.js";import"./helmet-D-y5f56R.js";import"./cookie-consent-h1U6JL3J.js";function tt(){const{t:e}=V("employee"),_=T(s=>s.authToken),o=B(s=>s.lang),[l,v]=n.useState(""),[a,c]=n.useState(null),[d,j]=n.useState(null),[m,u]=n.useState(!1),[x,h]=n.useState(!1),k=()=>{u(!0),h(!1),F.post(`${E}/api/tickets/scan/${l}`,{},{headers:{Authorization:`Bearer ${_}`,"Accept-Language":o}}).then(s=>{c(i=>({...i,...s.data})),h(!0)}).catch(s=>{var i;((i=s.response)==null?void 0:i.status)===409?c(s.response.data):j(e("errors.validate_error"))}).finally(()=>u(!1))},g=()=>{c(null),j(null),v(""),h(!1),u(!1)};return d?t.jsx(y,{children:t.jsx(I,{title:e("errors.genericErrorTitle"),message:d,showRetry:!0,retryButtonText:e("errors.retry"),onRetry:()=>{window.location.reload()},showHome:!0,homeButtonText:e("errors.home")})}):t.jsxs(t.Fragment,{children:[t.jsx(A,{title:e("seo.title_validate"),description:e("seo.description_validate")}),t.jsx(y,{disableCard:!0,children:t.jsxs(z,{sx:{p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[!a&&!d&&t.jsxs(t.Fragment,{children:[t.jsx(r,{variant:"h4",gutterBottom:!0,children:e("validate.title")}),t.jsxs(C,{sx:{textAlign:"center"},children:[t.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:2},children:e("validate.instructions_manual")}),t.jsxs(p,{component:"form",onSubmit:s=>{s.preventDefault(),k()},sx:{mb:3,display:"flex",flexDirection:"column",gap:1,justifyContent:"center"},children:[t.jsx(R,{label:e("validate.manual_label"),value:l,onChange:v}),t.jsx(f,{type:"submit",variant:"contained",disabled:m||!l,startIcon:m?t.jsx(D,{size:20}):null,children:e(m?"validate.validating":"validate.validate_button")})]})]})]}),a&&t.jsxs(t.Fragment,{children:[t.jsx(r,{variant:"h4",gutterBottom:!0,children:e(x?"scan.validated_title":"validate.results_title")}),x&&t.jsxs(p,{sx:{textAlign:"center",mb:2},children:[t.jsx(S,{sx:{fontSize:60,color:"success.main",display:"block",mx:"auto",mb:1}}),t.jsx(r,{variant:"h5",children:e("scan.validated_message",{dt:b(a.used_at,o)})}),t.jsx(f,{variant:"contained",onClick:g,sx:{mt:5},children:e("validate.reset_button")})]}),!x&&t.jsxs(t.Fragment,{children:[t.jsx(S,{sx:{fontSize:60,color:"error.main",display:"block",mx:"auto",mb:1}}),t.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:2},children:e("validate.not_good")}),t.jsxs(C,{sx:{textAlign:"left"},children:[t.jsxs(r,{variant:"h6",gutterBottom:!0,children:[t.jsx(P,{label:e(`scan.status.${a.status}`),color:w(a.status),size:"small",sx:{marginRight:1}}),a.event.name]}),t.jsx(r,{variant:"body1",children:e("scan.event_date",{date:b(a.event.date,o),time:a.event.time,location:a.event.location})}),t.jsx(r,{variant:"body1",sx:{mt:2},children:e("scan.client")}),t.jsxs(r,{variant:"body2",color:"text.secondary",children:[a.user.firstname," ",a.user.lastname,t.jsx("br",{}),a.user.email]}),t.jsx(p,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:t.jsx(f,{variant:"contained",sx:{mt:2,alignSelf:"flex-end"},onClick:g,children:e("validate.reset_button")})})]})]})]})]})})]})}export{tt as default};
