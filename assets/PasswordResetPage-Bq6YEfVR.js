import{r as t,j as s}from"./react-C0aVURRx.js";import{S as A}from"./Seo-DMFKsBC4.js";import{P as B}from"./PageWrapper-Ct9UgNZL.js";import{A as T,g}from"./AlertMessage-CNaxI2wP.js";import{a as W,e as D}from"./index-D-j-iQM9.js";import{P as F}from"./PasswordWithConfirmation-DCGeVHHG.js";import{i as N}from"./validation-491qobvS.js";import{u as U}from"./i18n-react-BJpG_9Eh.js";import{O as _,a2 as $}from"./vendor-D9jJ6Kpb.js";import{q as c,t as v,G as q,B as C,C as z,ab as G}from"./mui-7-KVGWFD.js";import"./dayjs-DMyafwSS.js";import"./helmet-0WMJf2Lb.js";import"./i18n-Bhc83OLH.js";import"./zustand-DgaMZn_z.js";import"./axios-xsH4HHeE.js";import"./emotion-P9cj9Rdp.js";import"./cookie-consent-CRxe7e1g.js";function is(){const{t:e}=U("passwordReset"),n=_(),R=W.getState().lang,[x]=$(),d=x.get("token")??"",k=x.get("email")??"",[l]=t.useState(k),[i,y]=t.useState(""),[m,M]=t.useState(""),[E,f]=t.useState(!1),[p,h]=t.useState(!1),[w,o]=t.useState(null),[a,S]=t.useState(null),b=N(i),j=i===m;t.useEffect(()=>{(!d||!l)&&n("/login",{replace:!0})},[d,l,n]);const L=async u=>{var P;if(u.preventDefault(),o(null),S(null),f(!0),!b){o(e("errors.passwordNotStrong"));return}if(!j){o(e("errors.passwordsDontMatch"));return}h(!0);try{const{status:r}=await D(d,l,i,m,R);if(r>=200&&r<300)S(e("passwordReset.successMessage"));else throw new Error("Unexpected status")}catch(r){r.response&&((P=r.response.data)!=null&&P.code)?o(g(e,r.response.data.code)):r.isAxiosError?o(g(e,"network_error")):o(g(e,"generic_error"))}finally{h(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(A,{title:e("seo.title"),description:e("seo.description")}),s.jsx(B,{disableCard:!0,children:s.jsxs(c,{component:"form",onSubmit:L,sx:{maxWidth:400,mx:"auto",mt:{xs:1,sm:4,md:8},p:4,borderRadius:2,boxShadow:3,backgroundColor:"background.paper",border:u=>`1px solid ${u.palette.divider}`},children:[s.jsx(v,{variant:"h4",gutterBottom:!0,align:"center",children:e("passwordReset.title")}),s.jsx(v,{variant:"body1",align:"center",sx:{mb:2},children:e("passwordReset.description")}),(w||a)&&s.jsx(c,{"aria-live":"polite",sx:{mb:2},children:s.jsx(T,{message:w??a,severity:a?"success":"error"})}),!a&&s.jsxs(q,{spacing:2,children:[s.jsx(F,{password:i,onPasswordChange:y,confirmPassword:m,onConfirmChange:M,touched:E,onBlur:()=>f(!0)}),s.jsx(C,{type:"submit",variant:"contained",fullWidth:!0,disabled:p||!b||!j,startIcon:p?s.jsx(z,{color:"inherit",size:16}):void 0,children:p?`${e("passwordReset.buttonLoading")}â€¦`:e("passwordReset.button")}),s.jsx(c,{sx:{textAlign:"center",mt:1},children:s.jsx(G,{component:"button",variant:"body2",onClick:()=>n("/login"),children:e("passwordReset.backToLogin")})})]}),a&&s.jsx(c,{sx:{textAlign:"center",mt:2},children:s.jsx(C,{variant:"outlined",onClick:()=>n("/login"),children:e("passwordReset.goToLogin")})})]})})]})}export{is as default};
