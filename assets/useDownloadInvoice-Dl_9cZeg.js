import{A as c,b as w}from"./index-0o0hW-SE.js";import{a as i}from"./axios-xsH4HHeE.js";import{r as g}from"./react-C0aVURRx.js";import{u as f}from"./useCustomSnackbar-KNVcHHHt.js";import{u as h}from"./i18n-react-2P1mIwau.js";async function A(t,a){const n={"Content-Type":"application/json",Authorization:`Bearer ${a}`},e={};t.status&&(e.status=t.status),t.date_from&&t.date_from.trim()!==""&&(e.date_from=t.date_from),t.date_to&&t.date_to.trim()!==""&&(e.date_to=t.date_to),e.sort_by=t.sort_by,e.sort_order=t.sort_order,e.per_page=t.per_page,e.page=t.page;const o=await i.get(`${c}/api/invoices`,{headers:n,params:e});return{status:o.status,data:o.data}}async function b(t,a){const n=`${c}/api/invoices/${encodeURIComponent(t)}`,e={"Content-Type":"application/json",Authorization:`Bearer ${a}`,Accept:"application/pdf"},o=await i.get(n,{headers:e,responseType:"blob"});if(o.status!==200)throw new Error(`Error while downloading invoice: HTTP ${o.status}`);return o.data}async function U(t,a){const n={Authorization:`Bearer ${a}`,Accept:"application/json"},e={};t.status&&(e.status=t.status),e.per_page=t.per_page,e.page=t.page,t.event_date_from&&t.event_date_from.trim()!==""&&(e.event_date_from=t.event_date_from.trim()),t.event_date_to&&t.event_date_to.trim()!==""&&(e.event_date_to=t.event_date_to.trim());const o=await i.get(`${c}/api/tickets/user`,{headers:n,params:e});return{status:o.status,data:o.data}}async function k(t,a){const n=t.replace(/^.*[\\/]/,"");if(!n)throw new Error(`Invalid filename: "${t}"`);const e=`${c}/api/tickets/${encodeURIComponent(n)}`,o={Authorization:`Bearer ${a}`,Accept:"application/pdf"},d=await i.get(e,{headers:o,responseType:"blob"});if(d.status!==200)throw new Error(`HTTP ${d.status}`);return d.data}async function E(t,a){const n=`${c}/api/tickets/qr/${encodeURIComponent(t)}`,e={Authorization:`Bearer ${a}`,Accept:"image/png"},o=await i.get(n,{headers:e,responseType:"blob"});if(o.status!==200)throw new Error(`HTTP ${o.status}`);return o.data}function I(){const t=w(p=>p.authToken),{t:a}=h("invoices"),{notify:n}=f(),[e,o]=g.useState(!1);return{download:async p=>{var m,_;if(!t){n(a("errors.not_authenticated"),"warning");return}o(!0);try{const u=await b(p,t),s=window.URL.createObjectURL(u),r=document.createElement("a");r.href=s,r.download=p,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(s),n(a("card.download_success"),"success")}catch(u){let s=a("errors.download_failed"),r="error";((m=u.response)==null?void 0:m.status)===404?(s=a("errors.not_found"),r="warning"):((_=u.response)==null?void 0:_.status)===401&&(s=a("errors.unauthorized"),r="warning"),n(s,r)}finally{o(!1)}},downloading:e}}export{k as a,E as b,U as c,A as g,I as u};
