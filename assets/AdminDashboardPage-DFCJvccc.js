import{r as d,j as e}from"./react-C0aVURRx.js";import{b as E,S as f,O as y,P as x}from"./index-DrEuU79R.js";import{a as w}from"./axios-xsH4HHeE.js";import{N as S,E as T,P as U,T as _,f as A}from"./TwoFASection-b8e4hzs-.js";import{g}from"./AlertMessage-DJxkIRCo.js";import{E as F}from"./ErrorDisplay-CPpgxCLY.js";import{u as P}from"./i18n-react-CLR_B6bE.js";import{q as h,t as j,N as B}from"./mui-DvHa722-.js";import{U as k}from"./vendor-BkFWaOq0.js";import"./dayjs-DMyafwSS.js";import"./zustand-DgaMZn_z.js";import"./i18n-Bhc83OLH.js";import"./emotion-BDhcDjNx.js";import"./helmet-OWuT_DBl.js";import"./cookie-consent-DmI9BIvn.js";import"./validation-491qobvS.js";import"./PasswordWithConfirmation-BQlLEpJ2.js";function X(){const{t:r}=P("userDashboard"),c=E(t=>t.authToken),[l,a]=d.useState(null),[b,u]=d.useState(!0),[p,m]=d.useState(null);return d.useEffect(()=>{if(!c){a(null),u(!1);return}const t=new AbortController,s=t.signal;return(async()=>{u(!0),m(null);try{const n=await A(c,{signal:s});if(s.aborted)return;const{status:i,data:o}=n;i===200&&o.user?a({firstname:o.user.firstname,lastname:o.user.lastname,email:o.user.email,twoFAEnabled:o.user.twofa_enabled}):m(r("errors.fetchProfile"))}catch(n){if(s.aborted)return;if(w.isAxiosError(n)&&n.response){const i=n.response.data,o=i==null?void 0:i.code;m(g(r,o??"generic_error"))}else m(g(r,"network_error"))}finally{s.aborted||u(!1)}})(),()=>{t.abort()}},[c,r]),b?e.jsxs(e.Fragment,{children:[e.jsx(f,{title:r("seo.title_admin"),description:r("seo.description_admin")}),e.jsx(h,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(y,{})})]}):p?e.jsx(x,{children:e.jsx(F,{title:r("errors.genericErrorTitle"),message:p,showRetry:!0,retryButtonText:r("errors.retry"),onRetry:()=>{window.location.reload()},showHome:!0,homeButtonText:r("errors.home")})}):l?e.jsxs(e.Fragment,{children:[e.jsx(f,{title:r("seo.title_admin"),description:r("seo.description_admin")}),e.jsx(x,{children:e.jsxs(h,{sx:{maxWidth:600,mx:"auto",mt:4,mb:4},children:[e.jsx(j,{variant:"h4",gutterBottom:!0,align:"center",children:r("dashboard.title_admin")}),e.jsx(j,{variant:"body1",gutterBottom:!0,align:"center",sx:{mb:4},children:r("dashboard.subtitle_admin")}),e.jsxs(B,{spacing:2,children:[e.jsx(S,{user:l,onUpdate:t=>a(s=>({...s,...t}))}),e.jsx(T,{currentEmail:l.email,onUpdate:t=>a(s=>({...s,email:t}))}),e.jsx(U,{}),e.jsx(_,{enabled:l.twoFAEnabled,onToggle:t=>a(s=>({...s,twoFAEnabled:t}))})]})]})})]}):e.jsx(k,{to:"/login",replace:!0})}export{X as default};
