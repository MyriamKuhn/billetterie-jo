import{r as t,j as s}from"./react-C0aVURRx.js";import{a as A,S as B,P as T,e as W}from"./index-CY5QxFiC.js";import{A as D,g}from"./AlertMessage-BDwJJZE0.js";import{P as F}from"./PasswordWithConfirmation-fPFCWCsA.js";import{i as N}from"./validation-491qobvS.js";import{u as O}from"./i18n-react-DKLIrUu3.js";import{O as U,a4 as _}from"./vendor-DdBxgcTm.js";import{q as c,v,O as $,B as R,r as q,a6 as z}from"./mui-CUyLNCSY.js";import"./dayjs-DMyafwSS.js";import"./axios-Dq7h7Pqt.js";import"./zustand-DgaMZn_z.js";import"./i18n-Bhc83OLH.js";import"./emotion-3DDxC2qG.js";import"./helmet-D-y5f56R.js";import"./cookie-consent-h1U6JL3J.js";function as(){const{t:e}=O("passwordReset"),n=U(),k=A.getState().lang,[x]=_(),d=x.get("token")??"",C=x.get("email")??"",[l]=t.useState(C),[i,y]=t.useState(""),[u,M]=t.useState(""),[E,h]=t.useState(!1),[p,f]=t.useState(!1),[w,o]=t.useState(null),[a,S]=t.useState(null),b=N(i),j=i===u;t.useEffect(()=>{(!d||!l)&&n("/login",{replace:!0})},[d,l,n]);const L=async m=>{var P;if(m.preventDefault(),o(null),S(null),h(!0),!b){o(e("errors.passwordNotStrong"));return}if(!j){o(e("errors.passwordsDontMatch"));return}f(!0);try{const{status:r}=await W(d,l,i,u,k);if(r>=200&&r<300)S(e("passwordReset.successMessage"));else throw new Error("Unexpected status")}catch(r){r.response&&((P=r.response.data)!=null&&P.code)?o(g(e,r.response.data.code)):r.isAxiosError?o(g(e,"network_error")):o(g(e,"generic_error"))}finally{f(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(B,{title:e("seo.title"),description:e("seo.description")}),s.jsx(T,{disableCard:!0,children:s.jsxs(c,{component:"form",onSubmit:L,sx:{maxWidth:400,mx:"auto",mt:{xs:1,sm:4,md:8},p:4,borderRadius:2,boxShadow:3,backgroundColor:"background.paper",border:m=>`1px solid ${m.palette.divider}`},children:[s.jsx(v,{variant:"h4",gutterBottom:!0,align:"center",children:e("passwordReset.title")}),s.jsx(v,{variant:"body1",align:"center",sx:{mb:2},children:e("passwordReset.description")}),(w||a)&&s.jsx(c,{"aria-live":"polite",sx:{mb:2},children:s.jsx(D,{message:w??a,severity:a?"success":"error"})}),!a&&s.jsxs($,{spacing:2,children:[s.jsx(F,{password:i,onPasswordChange:y,confirmPassword:u,onConfirmChange:M,touched:E,onBlur:()=>h(!0)}),s.jsx(R,{type:"submit",variant:"contained",fullWidth:!0,disabled:p||!b||!j,startIcon:p?s.jsx(q,{color:"inherit",size:16}):void 0,children:p?`${e("passwordReset.buttonLoading")}â€¦`:e("passwordReset.button")}),s.jsx(c,{sx:{textAlign:"center",mt:1},children:s.jsx(z,{component:"button",variant:"body2",onClick:()=>n("/login"),children:e("passwordReset.backToLogin")})})]}),a&&s.jsx(c,{sx:{textAlign:"center",mt:2},children:s.jsx(R,{variant:"outlined",onClick:()=>n("/login"),children:e("passwordReset.goToLogin")})})]})})]})}export{as as default};
