import{r as m,j as t}from"./react-C0aVURRx.js";import{b as C,a as w,u as P,S as y,O as U,P as _}from"./index-0-ZpxhMj.js";import{g as E,l as L}from"./paymentService-CX1qbzTb.js";import{E as b}from"./ErrorDisplay-Cr9dJZSt.js";import{u as B}from"./i18n-react-Cm5iFQwB.js";import{q as f,t as p,B as d}from"./mui-Ci1l0Ows.js";import{S as R,O as T}from"./vendor-DEk3LB1x.js";import"./dayjs-DMyafwSS.js";import"./axios-xsH4HHeE.js";import"./zustand-DgaMZn_z.js";import"./i18n-Bhc83OLH.js";import"./emotion-DNCOdpxi.js";import"./helmet-MDiytzVa.js";import"./cookie-consent-CxSVcpKG.js";function Q(){const{t:e}=B("checkout"),o=R(),n=T(),l=C(r=>r.authToken),S=w(r=>r.lang),x=P(r=>r.unlockCart),[k,s]=m.useState(!0),[h,a]=m.useState(null),[i,v]=m.useState(null);return m.useEffect(()=>{x();const r=o.state;let c=r==null?void 0:r.paymentUuid;const g=new URLSearchParams(o.search);if(!c&&g.get("paymentUuid")&&(c=g.get("paymentUuid")),!c){a(e("errors.no_uuid")),s(!1);return}if(!l){a(e("errors.not_authenticated")),s(!1),n(`/login?next=${encodeURIComponent(o.pathname+o.search)}`);return}(async()=>{s(!0),a(null);try{const{status:j,data:u}=await E(c,l);j===200&&u?v(u):(L("Unexpected status getPaymentStatus:",u),a(e("errors.fetch_error")))}catch{a(e("errors.fetch_error"))}finally{s(!1)}})()},[o,l,S,n,e,x]),k?t.jsxs(t.Fragment,{children:[t.jsx(y,{title:e("seo.confirmation_title"),description:e("seo.confirmation_description")}),t.jsx(f,{sx:{textAlign:"center",py:4},children:t.jsx(U,{})})]}):h?t.jsx(_,{children:t.jsx(b,{title:e("errors.error_confirmation"),message:h,showRetry:!1,showHome:!0,homeButtonText:e("confirmation.go_home")})}):t.jsxs(t.Fragment,{children:[t.jsx(y,{title:e("seo.confirmation_title"),description:e("seo.confirmation_description")}),t.jsx(_,{children:t.jsxs(f,{sx:{maxWidth:600,mx:"auto",mt:4,p:2},children:[t.jsx(p,{variant:"h4",gutterBottom:!0,children:e("confirmation.thank_you")}),t.jsx(p,{variant:"body1",sx:{mb:2},children:e("confirmation.see_mail")}),t.jsx(p,{variant:"body2",sx:{mb:2},children:e("confirmation.paid_at",{date:i!=null&&i.paid_at?new Date(i.paid_at).toLocaleString():"-"})}),t.jsxs(f,{sx:{mt:3},children:[t.jsx(d,{variant:"outlined",onClick:()=>n("/"),children:e("confirmation.continue_shopping")}),t.jsx(d,{variant:"text",sx:{ml:2},onClick:()=>n("/user/orders"),children:e("confirmation.view_orders")}),t.jsx(d,{variant:"text",sx:{ml:2},onClick:()=>n("/user/tickets"),children:e("confirmation.view_tickets")})]})]})})]})}export{Q as default};
